<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8"/>
    <title>Options</title>
    <!-- FONT -->
    <link rel="stylesheet" href="css/font.css">
    <!-- CSS -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/common.css">
  </head>

  <body style="overflow:hidden;">
    <div style="padding:15px;" >
      <div class="row" style="margin-top: 10px;padding-bottom:0px; width:250px; margin:auto;">
            <div class="u-pull-right">
                <img src="images/icon.png" draggable="false">
            </div>
            <div>
                <h1 class="font-no-select" style="border-left: 4px solid #98cee8; margin-right:0px; padding-right:0px; letter-spacing: 8px;"><span style="color:#2d6edb;">k</span>urer</h1>
            </div>
        </div>

        <form id="mainForm" style="margin-bottom:0px;">
          <div class="hl-border-strong"  style="margin-top:20px;" hidden>
          </div>

          <div class="hl-border-strong"  style="margin-top:20px;">
            <h6>Composing messages</h6>
            <div class="switchBox">
              <div>Seperate encrypt button</div>
              <label class="switch"><input id="opt_autoEncrypt" type="checkbox" /><div></div></label>
              <div>Always encrypt on send</div>
            </div>
            <div class="switchBox">
              <div>Not signed by default</div>
              <label class="switch"><input id="opt_autoSign" type="checkbox" /><div></div></label>
              <div>Signed by default</div>
            </div>
            <br>
            If unable to encrypt for a recipient:
            <div class="switchBox">
              <div>Silently send unencrypted</div>
              <label class="switch"><input id="opt_sendWarning" type="checkbox" /><div></div></label>
              <div>Halt and show warning</div>
            </div>
            <br>
            When replying to an encrypted message:
            <div class="switchBox">
              <div class="tooltip">Preserve encryption
                <span class="tooltiptext"><span class="color-mid">Note</span>: the recipient will be unable to read the quoted portion since it would remain encrypted for you</span>
              </div>
              <label class="switch"><input id="opt_replyEncr" type="checkbox" /><div></div></label>
              <div class="tooltip">Decrypt the reply quote
                <span class="tooltiptext">The original encrypted message will be decrypted when quoted in the reply, allowing the recipient to read it<br><br><span class="color-neg">Caution</span>: this permits you to send in-the-clear messages which were intended to be for your eyes only</span>
              </div>
            </div>
          </div>

          <div class="hl-border-strong" style="margin-top:20px;">
            <h6>Private keys</h6>
            <div class="switchBox">
              <div class="tooltip">Single key for sign/encr
                <span class="tooltiptext">If you want to use a <span class="color-mid">single&nbsp;key</span> for both signing and decrypting</span>
              </div>
              <label class="switch"><input id="opt_seperateKeys" type="checkbox" /><div></div></label>
              <div class="tooltip">Seperate keys for sign/encr
                <span class="tooltiptext">If you want to use <span class="color-mid">two&nbsp;keys</span>: one for signing and another for decrypting</span>
              </div>
            </div>
            <div class="hl-border-weak" style="margin-bottom:30px;">
              <h6 id="privKey_message">Key for decrypting and signing</h6>
              <textarea class="browser-style centered pem-input" id="privateKey" placeholder="[Paste PEM text]"></textarea>
              <br><br>
              Key password<br>
              <span style="font-size: x-small;" class="font-sub">Leave empty if your PKCS8 key above is not password encrypted</span>
              <input type="password" class="browser-style centered pem-input" id="passcode"/>
            </div>
            <div id="privKey2_section" class="hl-border-weak anim_scalein">
              <h6 id="privKey2_message">Key for signing</h6>
              <textarea class="browser-style centered pem-input" id="privateKey2" placeholder="[Paste PEM text]"></textarea>
              <br><br>
              Key password<br>
              <span style="font-size: x-small;" class="font-sub">Leave empty if your PKCS8 key above is not password encrypted</span>
              <input type="password" class="browser-style centered pem-input" id="passcode"/>
            </div>
          </div>
          <div class="hl-border-strong" style="margin-top:20px;">
            <h6>Your email address used when signing</h6>
            <span style="font-size: x-small;" class="font-sub">Should match your "From" address chosen when composing mail</span>
            <input type="email" class="browser-style centered pem-input" id="email" placeholder="john.doe@example.com"/>
          </div>
          <div class="hl-border-strong" style="margin-top:20px;">
            <h6>Other Options</h6>
            <div class="tooltip"><span style="font-size: x-small;" >DNS recursive resolver to use for DANE</span>
              <input type="url" class="browser-style centered pem-input" id="doh_server" placeholder="cloudflare-dns.com/dns-query"/>
              <span class="tooltiptext"><span class="color-mid">Note</span>: Kurer currently uses Cloudflare 1.1.1.1 HTTP GET JSON API, and will only work with compatible DoH resolvers.<br>Leave empty to use default. </span>
            </div>
            
          </div>
          <div class="hl-border-strong" style="margin-top:20px;" hidden>
            <h6>Certificate sent with signatures</h6>
            <span style="font-size: x-small;">Leave empty to pull from DANE</span>
            <textarea class="browser-style centered pem-input" id="cert" placeholder="[Paste PEM text]"></textarea>
          </div>
          
          <div class="hl-border-strong"  style="margin-top:20px;" hidden>
            <h6>Cache of known public keys</h6>
            For <b>debug</b> purposes you can modify a single entry
            <div id="cacheOptions" class="browser-style hl-border-weak">
                <label>email address</label>
                <input class="centered" type="text" id="1_cacheName" placeholder="email"/>
                <label>PEM certificate text</label>
                <textarea class="browser-style centered pem-input" id="1_cacheCert" placeholder="[Undefined]"></textarea>
            </div>
          </div>

          <!-- Save button -->
          <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items:center;" >
            <button class="browser-style" style="height:95%" type="submit">Save</button>
            <div class="hl-border-strong" style="display: flex; justify-content: left; align-items: center; justify-self: left; margin-left:10px; margin-right: 10px;"><input style="margin-right:10px;"type="checkbox" id="optSendStats" checked/>
              <div id="telemetry_msg" class="tooltip noselect font-sub clickable-text" style="font-size:smaller;">Help&nbsp;make&nbsp;Kurer&nbsp;better&nbsp;by&nbsp;sending<br>anonymous&nbsp;statistics&nbsp;to&nbsp;the&nbsp;devs
                <span class="tooltiptext">We send a one-time anonymous packet that only contains your toggled options under the <i>Composing messages</i> section along with a randomly generated client id when clicking <i>Save</i><br><br>No other data is sent</span>
            </div></div>
            <button style="justify-self:right;" style="height:95%" class="browser-style" type="reset">Reset</button>
          </div>
            

          
        </form>
    </div>

    <div style="display:flex; align-items: center; padding:10px; font-size:smaller; background-color:rgba(55,55,65,.5);">
        <div id="statusbar" style="padding-left:8px; border-left: 2px solid #98cee8; min-height: 20px;">
          <div id="statustext">Status</div>
        </div>
    </div>
    <script src="scripts/options.js"></script>
    
    <!-- User-study pitch modal -->
    <div id="user_study_modal" class="modal"><div class="modal-content-bottom">
      <div>
        <h2>Did you know?</h2>
        <p>Kurer is an <a href="https://github.com/gmu-msl/kurer-thunderbird">open-source project</a> and part of a study looking at <span class="color-pos-faint">cryptography designed for everyday people.</span></p>
        <p><span class="font-sub">// participation / consent</span><br>
          <a class="font-sub" href="https://docs.google.com/spreadsheets/d/1qY9R_eCTKV1DBe04KIrUDQjwzXL9CngMCv3ANYzomvs/edit?usp=sharing"> // telemetry advanced details</a>
        </p>
      </div>
      <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items:center;">
        <button id="ustud_yes_btn" class="browser-style button btn-green" style="height:95%" type="button" >Accept</button>
        <button id="ustud_no_btn" style="justify-self:right;" style="height:95%" class="browser-style button btn-red" type="reset">No Thanks</button>
      </div>
    </div></div>
  </body>
</html>